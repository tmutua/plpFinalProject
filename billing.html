<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bill Items</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" 
integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<link rel="stylesheet" href="styles.css">
<script src="https://www.gstatic.com/firebasejs/9.2.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.2.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/live/3.1/firebase.js"></script>
<style>
    #itemList{
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-sizing: border-box;
    
    }
</style>
</head>
<body class="container">
        <div class="top-bar">
            <div class="container d-flex justify-content-between align-items-center">
            <div class="hospital-name">
                <h5>Hospital Name</h5>
            </div>
            <div class="room-indicator">
                <h6>Room: Billing office</h6> <!-- Change "XYZ" with the room name/number -->
            </div>
            <div class="queue-button">
                <button class="btn btn-light">Queue</button>
            </div>
            </div>
        </div>
    <div>
    <div class="row">
        <h6>Add Bill Item</h6>
        <div class="col">
            <div>
                <label for="itemType">Item type</label>
                <select name="itemType" id="itemType" onchange="changeBillItem()">
                    <option value="product">Product</option>
                    <option value="service">Service</option>
                </select>
            </div>
            <div>
                <label for="itemName" id="itemLabel">Product name</label>
                <input type="search" id="itemName" onclick="showProductList()">
                <select id="itemList" size="20" onchange="selectProduct()" style="display: none;">
                    <!-- Product options will be populated here -->
                </select>
            </div>
            <div>
                <label for="billDateTime">Bill Date Time</label>
                <input type="datetime-local" id="billDateTime">
            </div>
        </div>
        <div class="col">
            <div>
                <label for="scheme">Scheme</label>
                <select name="scheme" id="scheme">
                    <option value="cashPayer">Cash payer</option>
                    <option value="nhif">NHIF</option>
                </select>
            </div>
            <div>
                <label for="unitPrice">Unit Price</label>
                <input type="number" id="unitPrice" readonly>
            </div>
            <div>
                <label for="quantity">Quantity</label>
                <input type="number" id="quantity">
            </div><br>
            <div>
                <button onclick="addItem()">Add Item +</button>
                <button onclick="newBill()">New</button>
                <p id="successMessage" class="success-message"></p>
            </div>
        </div>
        <div class="col">
            <div>
                <label for="saleType">Type of sale</label>
                <select name="saleType" id="saleType" onchange="toggleInvoiceButton()">
                    <option value="cashSale" selected>Cash sale</option>
                    <option value="credit">Credit sale</option>
                </select>
                <button id="invoiceButton">Create Invoice</button>
            </div>
            <div class="cashPay">
                <div class>
                    <label for="payMode">payment mode</label>
                    <select name="payMode" id="payMode" onchange="toggleRefrenceNumber()">
                        <option value="cash" selected>cash</option>
                        <option value="mobile">mobile</option>
                    </select>
                </div>
                <div class="mobilePay">
                    <label for="mpesaRefrence">Refrence code</label>
                    <input type="text" id="mpesaRefrence" name="mpesaRefrence">
                </div>
                   
                <div>
                    <label for="totalAmount">Total Amount</label>
                    <input type="number" id="totalAmount" readonly>
                </div>
                <div>
                    <label for="amountTendered">Amount Tendered</label>
                    <input type="number" id="amountTendered" oninput="calculateChange()">
                </div>
                <div>
                    <label for="changeAmount">Change Amount</label>
                    <input type="number" id="changeAmount" readonly>
                </div><br>
                <div>
                    <button onclick="savePayment()"> save payment</button>
                </div>
            </div>
        </div>
    </div>

</div>













<h6>Bill Items</h6>
<table id="billItems">
  <tr>
    <th>Select</th>
    <th>Item Name</th>
    <th>Bill Date Time</th>
    <th>Scheme</th>
    <th>Unit Price</th>
    <th>Quantity</th>
    <th>Net Amount</th>
  </tr>
</table>
<script>
    
    const firebaseConfig = {
        apiKey: "AIzaSyDJBNgYDCJoOY3cOLUUK7JWNf-dx1_B3vY",
        authDomain: "teetech-67c26.firebaseapp.com",
        databaseURL: "https://teetech-67c26-default-rtdb.firebaseio.com",
        projectId: "teetech-67c26",
        storageBucket: "teetech-67c26.appspot.com",
        messagingSenderId: "307099503704",
        appId: "1:307099503704:web:f31cddc061f3fbfc598e2d"
};
firebase.initializeApp(firebaseConfig);

const database = firebase.database();
const productRef = database.ref('products');
const serviceRef = database.ref('services');

// Function to show product list when input is clicked
function showProductList() {
      const itemList = document.getElementById('itemList');
      itemList.style.display = 'block';
      productRef.once('value', function(snapshot) {
        itemList.innerHTML = ''; // Clear previous results
        snapshot.forEach(function(childSnapshot) {
          const product = childSnapshot.val();
          const option = document.createElement('option');
          option.text = product.productName;
          option.value = product.unitPrice;
          itemList.add(option);
        });
      });
    }

    // Function to populate unit price when a product is selected
    function selectProduct() {
         // Clear item name and rate
         document.getElementById('itemName').value = '';
        document.getElementById('unitPrice').value = '';
      const selectedProductName = document.getElementById('itemName');
      const selectedUnitPrice = document.getElementById('itemList').value;
      selectedProductName.value = document.getElementById('itemList').options[document.getElementById('itemList').selectedIndex].text;
      document.getElementById('unitPrice').value = selectedUnitPrice;
      document.getElementById('itemList').style.display = 'none';
    
    }
    // Function to show service list when input is clicked
    function showServiceList() {
      const itemList = document.getElementById('itemList');
      itemList.style.display = 'block';

      serviceRef.once('value', function(snapshot) {
        itemList.innerHTML = ''; // Clear previous results

        snapshot.forEach(function(childSnapshot) {
          const service = childSnapshot.val();
          const option = document.createElement('option');
          option.text = service.serviceName;
          option.value = service.serviceRate;
          itemList.add(option);
        });
      });
    }

    
</script>






<script src="emr.js"></script>

</body>
</html>